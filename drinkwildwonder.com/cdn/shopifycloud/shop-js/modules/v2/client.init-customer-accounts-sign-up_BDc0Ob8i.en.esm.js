import"./client.shop-login-button_DwzQxKIp.en.esm.js";import{D as t,a1 as e,i as n,Y as o,a4 as i,ac as s,ad as a,k as r,ae as c,af as l,a7 as u,a9 as m}from"./chunk.common_9bWy_6S0.esm.js";import"./chunk.modal_ByBoMpEK.esm.js";function d(){return t(this,arguments,void 0,(function*(t=!1){var m,d;const p=e(),f={analyticsContext:"loginWithShopClassicCustomerAccounts",analyticsTraceId:p,apiKey:"",flow:"classic_customer_accounts",flowVersion:"sign_up",shopPermanentDomain:null!==(d=null===(m=n.Shopify)||void 0===m?void 0:m.shop)&&void 0!==d?d:"",source:"initCustomerAccountsSignUp"},h=new o("initCustomerAccountsSignUp"),g=new i({analyticsData:f,notify:h.notify});try{!function(){const e=new WeakMap;let o=null;const i=s({onVisible:v,onFallback:t=>{t.addEventListener("focus",m,{once:!0}),g.produceMonorailEvent({event:{payload:Object.assign(Object.assign({},f),{errorCode:"fallback_to_focus_event",errorMessage:"Fallback to focus event for classic customer accounts",sdkVersion:"1.0.31-beta"}),schemaId:"shopify_pay_login_with_shop_sdk_error_events/1.0"}})}});function m(t){v(t.target)}function d(t,e){var o,i;const s=null===(o=t.elements.namedItem("checkout_url"))||void 0===o?void 0:o.value,a=null===(i=t.elements.namedItem("return_url"))||void 0===i?void 0:i.value,r=new URLSearchParams(Object.assign(Object.assign({analytics_trace_id:e},s&&{checkout_url:s}),a&&{return_url:a}));return`${n.location.origin}/account/redirect?${r.toString()}`}function v(i){var s;const a=i.form;if(!a)return void h.notify(new Error("Email form missing for classic customer accounts"));e.has(i)&&(h.notify(new Error("Input listener already exists for input")),null===(s=e.get(i))||void 0===s||s.destroy(),e.delete(i));const m=r.createElement("input");m.type="hidden",m.name="login_with_shop[analytics_trace_id]",m.value=p,a.appendChild(m),o||(o=function(t){const e=null===r.querySelector('form[data-login-with-shop-sign-in] input[type="email"],form[data-login-with-shop-sign-in] input[name="customer[email]"'),n="true"===l("signInWithShop:modalDismissed"),o=e&&!n,i=u("shop-login-button"),s=Object.assign(Object.assign(Object.assign({"analytics-context":"loginWithShopClassicCustomerAccounts"},o?{"auto-open":!0}:{}),{"client-id":"","disable-sign-up":!0,"flow-version":"sign_up","hide-button":!0,proxy:!0}),t&&{"ux-mode":"windoid","response-type":"code"});return Object.entries(s).forEach((([t,e])=>{i.setAttribute(t,String(e))})),r.body.appendChild(i),i}(t),o.addEventListener("completed",(()=>{const t=d(a,p);n.location.assign(t)})));const f=a.querySelector('input[name="customer[first_name]"'),g=a.querySelector('input[name="customer[last_name]"');o.setAttribute("firstName",(null==f?void 0:f.value)||""),o.setAttribute("lastName",(null==g?void 0:g.value)||""),o.setAttribute("email",i.value),e.set(i,new c(i,(t=>{o&&(o.setAttribute("firstName",(null==f?void 0:f.value)||""),o.setAttribute("lastName",(null==g?void 0:g.value)||""),o.setAttribute("email",t))})))}a({selector:'form[data-login-with-shop-sign-up] input[type="email"],form[data-login-with-shop-sign-up] input[name="customer[email]"',onElementFound:t=>i.observe(t)})}()}catch(t){t instanceof Error&&h.notify(t)}}))}m("initCustomerAccountsSignUp",d);
//# sourceMappingURL=client.init-customer-accounts-sign-up_BDc0Ob8i.en.esm.js.map
